# Настройка удаленной базы данных PostgreSQL

Этот файл содержит инструкции по настройке удаленной базы данных PostgreSQL для проекта Task Manager.

## Шаг 1: Выберите провайдера базы данных

Вы можете использовать один из следующих провайдеров:

### 1. Vercel Postgres (рекомендуется для деплоя на Vercel)
- Бесплатный тариф: 256 MB storage, 60 hours compute/month
- Создайте базу данных в дашборде Vercel
- Автоматически получаете `POSTGRES_PRISMA_URL` и `POSTGRES_URL_NON_POOLING`

### 2. Supabase
- Бесплатный тариф: 500 MB database, 2 GB bandwidth
- Регистрация: https://supabase.com
- Создайте новый проект → Settings → Database → Connection string

### 3. Neon
- Бесплатный тариф: 3 GB storage, unlimited compute
- Регистрация: https://neon.tech
- Создайте проект → Connection string

### 4. Railway
- Бесплатный тариф: $5 кредитов в месяц
- Регистрация: https://railway.app
- New Project → Database → PostgreSQL

### 5. Render
- Бесплатный тариф: 90 дней бесплатно, затем платно
- Регистрация: https://render.com
- New → PostgreSQL

## Шаг 2: Получите строку подключения

После создания базы данных скопируйте строку подключения (Connection String).

Формат обычно выглядит так:
```
postgresql://username:password@host:port/database?schema=public
```

## Шаг 3: Обновите файл .env

Откройте файл `.env` в корне проекта и замените `DATABASE_URL` на вашу строку подключения:

```env
DATABASE_URL="postgresql://username:password@host:5432/database?schema=public"
```

**Важно:** Не коммитьте файл `.env` в Git! Он уже добавлен в `.gitignore`.

## Шаг 4: Примените миграции базы данных

После настройки `DATABASE_URL` в `.env`, примените миграции Prisma:

```bash
npx prisma migrate deploy
```

Или для разработки (создаст новую миграцию):

```bash
npx prisma migrate dev --name init
```

Это создаст все необходимые таблицы в вашей удаленной базе данных.

## Шаг 5: Проверьте подключение

Проверьте, что подключение работает:

```bash
npx prisma studio
```

Откроется веб-интерфейс по адресу `http://localhost:5555` для просмотра данных.

## Шаг 6: Запустите приложение

Теперь можно запустить dev-сервер:

```bash
npm run dev
```

И попробовать зарегистрировать пользователя на странице `/signup`.

## Решение проблем

### Ошибка подключения

Если видите ошибку "Can't reach database server":
1. Проверьте, что строка подключения в `.env` корректна
2. Убедитесь, что база данных доступна из интернета (не заблокирована файрволом)
3. Проверьте, что IP-адрес не заблокирован провайдером БД

### Ошибка миграций

Если миграции не применяются:
1. Убедитесь, что база данных создана
2. Проверьте права доступа пользователя БД
3. Попробуйте выполнить: `npx prisma db push` (для разработки)

### SSL подключение

Некоторые провайдеры требуют SSL. Добавьте в строку подключения:
```
?sslmode=require
```

Пример:
```
DATABASE_URL="postgresql://user:pass@host:5432/db?schema=public&sslmode=require"
```

## Безопасность

⚠️ **Важно:**
- Никогда не коммитьте файл `.env` в Git
- Не делитесь строкой подключения публично
- Регулярно меняйте пароли базы данных
- Используйте переменные окружения на платформах деплоя (Vercel, Railway и т.д.)
